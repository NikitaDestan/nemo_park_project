{% extends 'nemo_park/base.html' %}

{% block title %}–†–∞—Å—á—ë—Ç–Ω—ã–µ –ª–∏—Å—Ç—ã{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-title">üí∞ –†–∞—Å—á—ë—Ç–Ω—ã–µ –ª–∏—Å—Ç—ã</div>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="stats-grid">
    <div class="stat-card green">
        <div class="stat-icon">üíµ</div>
        <div class="stat-number">{{ total_paid|floatformat:0 }} ‚ÇΩ</div>
        <div class="stat-label">–í—ã–ø–ª–∞—á–µ–Ω–æ</div>
    </div>
    <div class="stat-card orange">
        <div class="stat-icon">‚è≥</div>
        <div class="stat-number">{{ pending_count }}</div>
        <div class="stat-label">–û–∂–∏–¥–∞—é—Ç –≤—ã–ø–ª–∞—Ç—ã</div>
    </div>
    <div class="stat-card">
        <div class="stat-icon">üìã</div>
        <div class="stat-number">{{ payrolls|length }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
    </div>
</div>

<!-- –ö–Ω–æ–ø–∫–∏ -->
<div class="buttons-center">
    <a href="{% url 'payroll_calculate' %}" class="btn btn-success">üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É</a>
    <a href="{% url 'payroll_bulk' %}" class="btn btn-primary">üìä –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—á—ë—Ç</a>
    <a href="{% url 'payroll_bulk_delete' %}" class="btn btn-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å...</a>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ -->
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>üë§ –°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                <th>üìÖ –ü–µ—Ä–∏–æ–¥</th>
                <th>‚è±Ô∏è –ß–∞—Å–æ–≤</th>
                <th>üíµ –ù–∞—á–∏—Å–ª–µ–Ω–æ</th>
                <th>üìâ –ù–î–§–õ</th>
                <th>üí∞ –ö –≤—ã–ø–ª–∞—Ç–µ</th>
                <th>üìä –°—Ç–∞—Ç—É—Å</th>
                <th>‚öôÔ∏è</th>
            </tr>
        </thead>
        <tbody>
            {% for payroll in payrolls %}
            <tr>
                <td>
                    <strong>{{ payroll.employee.full_name }}</strong>
                    <br>
                    <span class="badge badge-{{ payroll.employee.position }}">
                        {{ payroll.employee.get_position_display }}
                    </span>
                </td>
                <td>
                    {{ payroll.period_start|date:"d.m" }} ‚Äî {{ payroll.period_end|date:"d.m.Y" }}
                </td>
                <td>{{ payroll.total_hours|floatformat:1 }}—á</td>
                <td>{{ payroll.gross_salary|floatformat:0 }} ‚ÇΩ</td>
                <td style="color: #e74c3c;">-{{ payroll.ndfl_tax|floatformat:0 }} ‚ÇΩ</td>
                <td><strong style="color: #00b894;">{{ payroll.net_salary|floatformat:0 }} ‚ÇΩ</strong></td>
                <td>
                    {% if payroll.status == 'paid' %}
                        <span class="badge" style="background: #00b894; color: white;">‚úÖ –í—ã–ø–ª–∞—á–µ–Ω–æ</span>
                    {% elif payroll.status == 'confirmed' %}
                        <span class="badge" style="background: #0077B6; color: white;">üìã –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω</span>
                    {% else %}
                        <span class="badge" style="background: #f39c12; color: white;">‚è≥ –ß–µ—Ä–Ω–æ–≤–∏–∫</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'payroll_detail' payroll.pk %}" class="btn btn-primary" style="padding: 8px 12px; font-size: 0.85rem;">üëÅÔ∏è</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <p>–†–∞—Å—á—ë—Ç–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                        <a href="{% url 'payroll_calculate' %}" class="btn btn-success" style="margin-top: 15px;">üßÆ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}