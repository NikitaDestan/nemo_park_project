{% extends 'nemo_park/base.html' %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞{% endblock %}

{% block content %}
<div class="page-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</div>

<div class="form-container">
    <form method="post">
        {% csrf_token %}
        
        <h3 style="margin: 0 0 20px; color: #023E8A;">üë§ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
        
        <div class="form-grid-2">
            <div class="form-group">
                <label>–ò–º—è *</label>
                {{ form.first_name }}
            </div>
            <div class="form-group">
                <label>–§–∞–º–∏–ª–∏—è *</label>
                {{ form.last_name }}
            </div>
        </div>
        
        <div class="form-grid-2">
            <div class="form-group">
                <label>–î–æ–ª–∂–Ω–æ—Å—Ç—å *</label>
                {{ form.position }}
            </div>
            <div class="form-group">
                <label>–°—Ç–∞–≤–∫–∞ ‚ÇΩ/—á–∞—Å</label>
                {{ form.hourly_rate }}
                <small style="color: #666;">–û—Å—Ç–∞–≤—å—Ç–µ 0 –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç–∞–≤–∫–∏ –ø–æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏</small>
            </div>
        </div>
        
        <h3 style="margin: 25px 0 15px; color: #023E8A;">üïê –ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã</h3>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ –ø—Ä–æ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É -->
        <div style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); padding: 15px 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #0077B6;">
            <strong style="color: #023E8A;">üí° –ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∑–∞—Ä–ø–ª–∞—Ç–∞:</strong>
            <ul style="margin: 10px 0 0 0; padding-left: 20px; color: #555;">
                <li><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–µ–Ω—å = 8 —á–∞—Å–æ–≤</strong></li>
                <li>–ï—Å–ª–∏ —Å–º–µ–Ω–∞ <strong>‚â§ 8 —á–∞—Å–æ–≤</strong> ‚Äî –æ–±—ã—á–Ω–∞—è —Å—Ç–∞–≤–∫–∞</li>
                <li>–ï—Å–ª–∏ —Å–º–µ–Ω–∞ <strong>> 8 —á–∞—Å–æ–≤</strong> ‚Äî –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è <strong>√ó1.5</strong></li>
            </ul>
            <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px; font-size: 0.9rem;">
                <strong>–ü—Ä–∏–º–µ—Ä:</strong> 09:00-18:00 (–ø–µ—Ä–µ—Ä—ã–≤ 1—á) = <span style="color: #00b894;">8—á ‚úì —Å—Ç–∞–Ω–¥–∞—Ä—Ç</span><br>
                <strong>–ü—Ä–∏–º–µ—Ä:</strong> 10:00-20:00 (–ø–µ—Ä–µ—Ä—ã–≤ 1—á) = <span style="color: #f39c12;">9—á = 8—á + 1—á –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏</span>
            </div>
        </div>
        
        <div class="form-grid-3">
            <div class="form-group">
                <label>–ù–∞—á–∞–ª–æ –¥–Ω—è</label>
                {{ form.work_start }}
            </div>
            <div class="form-group">
                <label>–ö–æ–Ω–µ—Ü –¥–Ω—è</label>
                {{ form.work_end }}
            </div>
            <div class="form-group">
                <label>–ü–µ—Ä–µ—Ä—ã–≤ (–º–∏–Ω)</label>
                {{ form.break_minutes }}
            </div>
        </div>
        
        <!-- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —á–∞—Å–æ–≤ -->
        <div id="hours-calculator" style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px; display: none;">
            <span style="font-size: 1.1rem;">
                ‚è±Ô∏è –†–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å: <strong id="calc-hours">0</strong>
                <span id="overtime-badge" style="display: none; margin-left: 10px; background: #f39c12; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.85rem;">
                    üî• –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞: <span id="calc-overtime">0</span>—á
                </span>
            </span>
        </div>
        
        <div class="form-group">
            <label>–†–∞–±–æ—á–∏–µ –¥–Ω–∏</label>
            {{ form.work_days }}
            <small style="color: #666;">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –¥–Ω–µ–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: 1=–ü–Ω, 2=–í—Ç, 3=–°—Ä, 4=–ß—Ç, 5=–ü—Ç, 6=–°–±, 7=–í—Å</small>
        </div>
        
        <!-- –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –¥–Ω–µ–π -->
        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
            <button type="button" class="btn btn-secondary" onclick="setWorkDays('1,2,3,4,5')" style="padding: 8px 15px;">
                üìÖ –ü–Ω-–ü—Ç
            </button>
            <button type="button" class="btn btn-secondary" onclick="setWorkDays('1,2,3,4,5,6')" style="padding: 8px 15px;">
                üìÖ –ü–Ω-–°–±
            </button>
            <button type="button" class="btn btn-secondary" onclick="setWorkDays('2,3,4,5,6')" style="padding: 8px 15px;">
                üìÖ –í—Ç-–°–±
            </button>
            <button type="button" class="btn btn-secondary" onclick="setWorkDays('3,4,5,6,7')" style="padding: 8px 15px;">
                üìÖ –°—Ä-–í—Å
            </button>
        </div>
        
        <h3 style="margin: 25px 0 15px; color: #023E8A;">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
        
        <div class="form-grid-2">
            <div class="form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                {{ form.phone }}
            </div>
            <div class="form-group">
                <label>Email</label>
                {{ form.email }}
            </div>
        </div>
        
        <h3 style="margin: 25px 0 15px; color: #023E8A;">üîë –£—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å</h3>
        
        <div class="form-grid-2">
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω *</label>
                {{ form.username }}
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å *</label>
                {{ form.password }}
            </div>
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 30px;">
            <button type="submit" class="btn btn-success">‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
            <a href="{% url 'employees' %}" class="btn btn-secondary">‚Üê –û—Ç–º–µ–Ω–∞</a>
        </div>
    </form>
</div>

<script>
function setWorkDays(days) {
    document.getElementById('id_work_days').value = days;
}

// –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —á–∞—Å–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
function calculateHours() {
    var startInput = document.getElementById('id_work_start');
    var endInput = document.getElementById('id_work_end');
    var breakInput = document.getElementById('id_break_minutes');
    var calculator = document.getElementById('hours-calculator');
    var hoursSpan = document.getElementById('calc-hours');
    var overtimeBadge = document.getElementById('overtime-badge');
    var overtimeSpan = document.getElementById('calc-overtime');
    
    if (!startInput.value || !endInput.value) {
        calculator.style.display = 'none';
        return;
    }
    
    var start = startInput.value.split(':');
    var end = endInput.value.split(':');
    var breakMin = parseInt(breakInput.value) || 60;
    
    var startMinutes = parseInt(start[0]) * 60 + parseInt(start[1]);
    var endMinutes = parseInt(end[0]) * 60 + parseInt(end[1]);
    
    // –ï—Å–ª–∏ –∫–æ–Ω–µ—Ü —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞ ‚Äî –Ω–æ—á–Ω–∞—è —Å–º–µ–Ω–∞
    if (endMinutes <= startMinutes) {
        endMinutes += 24 * 60;
    }
    
    var totalMinutes = endMinutes - startMinutes - breakMin;
    var hours = (totalMinutes / 60).toFixed(1);
    
    calculator.style.display = 'block';
    hoursSpan.textContent = hours;
    hoursSpan.style.color = hours > 8 ? '#f39c12' : '#00b894';
    
    if (hours > 8) {
        var overtime = (hours - 8).toFixed(1);
        overtimeSpan.textContent = overtime;
        overtimeBadge.style.display = 'inline';
    } else {
        overtimeBadge.style.display = 'none';
    }
}

// –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
document.getElementById('id_work_start').addEventListener('change', calculateHours);
document.getElementById('id_work_end').addEventListener('change', calculateHours);
document.getElementById('id_break_minutes').addEventListener('input', calculateHours);

// –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç
calculateHours();
</script>
{% endblock %}